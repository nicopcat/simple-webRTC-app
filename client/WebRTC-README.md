# WebRTC 视频通话应用使用说明

这是一个基于 Vue 3 + TypeScript 的简单 WebRTC 视频通话应用示例。

## 功能特性

- 本地视频预览
- 点对点视频通话
- 手动信令交换（适合学习和测试）
- 连接状态监控

## 使用步骤

### 1. 启动应用
```bash
cd client
npm run dev
```

### 2. 建立视频通话

#### 发起方（Alice）：
1. 点击"开启本地视频"按钮，允许浏览器访问摄像头和麦克风
2. 点击"创建通话邀请"按钮
3. 复制"发送给对方的信令"文本框中的内容
4. 通过任何方式（QQ、微信、邮件等）发送给接收方

#### 接收方（Bob）：
1. 点击"开启本地视频"按钮
2. 将发起方发来的信令数据粘贴到"接收对方的信令"文本框
3. 点击"处理信令"按钮
4. 点击"接受通话邀请"按钮
5. 复制生成的应答信令发送给发起方

#### 发起方完成连接：
1. 将接收方发来的应答信令粘贴到"接收对方的信令"文本框
2. 点击"处理信令"按钮
3. 等待连接建立完成

### 3. 通话管理
- 观察连接状态和 ICE 状态的变化
- 点击"挂断"按钮结束通话

## 技术说明

### WebRTC 核心概念
- **MediaStream**: 本地音视频流
- **RTCPeerConnection**: 点对点连接对象
- **SDP (Session Description Protocol)**: 会话描述协议
- **ICE (Interactive Connectivity Establishment)**: 交互式连接建立

### 信令流程
1. 发起方创建 Offer
2. 接收方设置远程描述，创建 Answer
3. 发起方设置远程描述
4. ICE 候选交换（本示例中简化处理）

### STUN 服务器
使用 Google 的公共 STUN 服务器来处理 NAT 穿透：
- `stun:stun.l.google.com:19302`
- `stun:stun1.l.google.com:19302`

## 扩展建议

### 1. 添加信令服务器
当前使用手动复制粘贴信令，实际应用中应该使用 WebSocket 或其他实时通信方式。

### 2. 添加 TURN 服务器
对于复杂网络环境，可能需要 TURN 服务器来中继流量。

### 3. 错误处理优化
添加更完善的错误处理和用户提示。

### 4. 多人通话
扩展为支持多人视频会议。

### 5. 屏幕共享
添加屏幕共享功能。

## 常见问题

### Q: 无法访问摄像头？
A: 检查浏览器权限设置，确保允许网站访问摄像头和麦克风。

### Q: 连接建立失败？
A: 检查网络环境，某些企业网络可能阻止 WebRTC 连接。

### Q: 视频卡顿？
A: 检查网络带宽，WebRTC 会自动调整视频质量。

## 浏览器兼容性

- Chrome 56+
- Firefox 44+
- Safari 11+
- Edge 79+

## 安全注意事项

- WebRTC 需要 HTTPS 环境（开发环境 localhost 除外）
- 注意用户隐私，合理请求媒体权限
- 生产环境建议使用自己的 STUN/TURN 服务器